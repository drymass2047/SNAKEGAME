<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Snake Game</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background-color: #2C3E50;
    }
    canvas {
      border: 1px solid #34495E;
    }
  </style>
</head>
<body>
  <canvas id="canvas" width="600" height="600"></canvas>
  <script>
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    const config = {
      sizeCell: 24,
      sizeFood: 24,
      step: 0,
      stepMax: 7,
    };

    const snake = {
      x: config.sizeCell,
      y: config.sizeCell,
      dirX: 0, // direction X
      dirY: 0, // direction Y
      body: [],
      maxBodySize: 1,
    };

    const food = {
      x: randomInt(0, canvas.width / config.sizeCell) * config.sizeCell,
      y: randomInt(0, canvas.height / config.sizeCell) * config.sizeCell,
    };

    const bomb = {
      x: -config.sizeCell,
      y: -config.sizeCell,
    };

    function randomInt(min, max) {
      return Math.floor(Math.random() * (max - min)) + min;
    }

    function reset() {
      snake.x = config.sizeCell;
      snake.y = config.sizeCell;
      snake.dirX = 0;
      snake.dirY = 0;
      snake.body = [];
      snake.maxBodySize = 1;
      config.stepMax = 7;
      spawnFood();
    }

    function checkCollision(x, y, obj) {
      return x === obj.x && y === obj.y;
    }

    function spawnFood() {
      let newX, newY;
      do {
        newX = randomInt(0, canvas.width / config.sizeCell) * config.sizeCell;
        newY = randomInt(0, canvas.height / config.sizeCell) * config.sizeCell;
      } while (snake.body.some((cell) => checkCollision(newX, newY, cell)));
      food.x = newX;
      food.y = newY;
    }

    function spawnBomb() {
      let newX, newY;
      do {
        newX = randomInt(0, canvas.width / config.sizeCell) * config.sizeCell;
        newY = randomInt(0, canvas.height / config.sizeCell) * config.sizeCell;
      } while (snake.body.some((cell) => checkCollision(newX, newY, cell)));
      bomb.x = newX;
      bomb.y = newY;
    }

    function snakeStyles(e, index) {
      if (index === 0) {
        ctx.fillStyle = "#2ECC71"; // Head color
      } else {
        ctx.fillStyle = "#093D14"; // Body color
      }
      ctx.strokeStyle = "#071510";
      ctx.lineWidth = 1;
  ctx.fillRect(e.x, e.y, config.sizeCell, config.sizeCell);
      ctx.strokeRect(e.x, e.y, config.sizeCell - 1, config.sizeCell - 1);
    }

    function drawFood() {
      ctx.fillStyle = "#E74C3C"; // Food color
      ctx.fillRect(food.x, food.y, config.sizeFood, config.sizeFood);
    }

    function drawBomb() {
      ctx.fillStyle = "#8E44AD"; // Bomb color
      ctx.fillRect(bomb.x, bomb.y, config.sizeFood, config.sizeFood);
    }

    function gameLoop() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      if (config.step === 0 && snake.dirX !== 0 || snake.dirY !== 0) {
        spawnBomb();
      }

      config.step++;
      if (config.step >= config.stepMax) {
        snake.body.unshift({ x: snake.x, y: snake.y });

        snake.x += snake.dirX * config.sizeCell;
        snake.y += snake.dirY * config.sizeCell;

        if (snake.body.length > snake.maxBodySize) {
          snake.body.pop();
        }

        if (snake.x < 0 || snake.y < 0 || snake.x >= canvas.width || snake.y >= canvas.height || snake.body.slice(1).some(cell => checkCollision(snake.x, snake.y, cell))) {
          reset();
        }

        if (checkCollision(snake.x, snake.y, food)) {
          snake.maxBodySize++;
          config.stepMax = Math.max(1, config.stepMax - 1);
          spawnFood();
        }

        if (checkCollision(snake.x, snake.y, bomb)) {
          reset();
        }

        config.step = 0;
      }

      snake.body.forEach(snakeStyles);
      drawFood();
      drawBomb();

      requestAnimationFrame(gameLoop);
    }

    document.addEventListener("keydown", (e) => {
      if (e.key === "ArrowUp" && snake.dirY === 0) {
        snake.dirX = 0;
        snake.dirY = -1;
      } else if (e.key === "ArrowDown" && snake.dirY === 0) {
        snake.dirX = 0;
        snake.dirY = 1;
      } else if (e.key === "ArrowLeft" && snake.dirX === 0) {
        snake.dirX = -1;
        snake.dirY = 0;
      } else if (e.key === "ArrowRight" && snake.dirX === 0) {
        snake.dirX = 1;
        snake.dirY = 0;
      }
    });

    spawnFood();
    gameLoop();
  </script>
</body>
